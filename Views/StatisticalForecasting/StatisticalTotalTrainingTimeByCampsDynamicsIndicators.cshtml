<link rel="stylesheet" href="~/css/GraphicsStyle.css" />

<body>
<div class="card">
    <h3>Статистические показатели динамики общего времени тренировочного процесса по лагерям</h3>
</div>

<table>
    <tr>
        <th rowspan = 2 style="text-align: center;">№</th>
        <th rowspan = 2 style="text-align: center;">Период лагеря</th>
        <th rowspan = 2 style="text-align: center;">Общее тренировочное время, мин.</th>
        <th colspan = 2 style="text-align: center;">Абсолютный прирост, мин.</th>
        <th colspan=2 style="text-align: center;">Темп роста, %</th>
        <th colspan=2 style="text-align: center;">Темп прироста, %</th>
        <tr>
            <td style="text-align: center;">Цепной</td>
            <td style="text-align: center;">Базисный</td>
            
            <td style="text-align: center;">Цепной</td>
            <td style="text-align: center;">Базисный</td>
            
            <td style="text-align: center;">Цепной</td>
            <td style="text-align: center;">Базисный</td>
        </tr>
           
    </tr>

    @if (ViewBag.TotalTrainingTimeForTrainingCamps is not null)
    {
        TotalTrainingCampsDurationView previousTotalTrainingCampsDuration;
        
        @for (int i = 0; i < (ViewBag.TotalTrainingTimeForTrainingCamps as IEnumerable<TotalTrainingCampsDurationView>).Count(); i++)
        {
            TotalTrainingCampsDurationView firstTotalTrainingCampsDuration = ViewBag.TotalTrainingTimeForTrainingCamps[0];
            TotalTrainingCampsDurationView currentTotalTrainingCampsDuration = ViewBag.TotalTrainingTimeForTrainingCamps[i];
            
            if (i == 0)
            {
                <tr>
                    <td style="text-align: center;">@(i + 1)</td>
                    <td style="text-align: center;">@currentTotalTrainingCampsDuration.TimeInterval.StartIntervalTime.ToShortDateString() - @currentTotalTrainingCampsDuration.TimeInterval.EndIntervalTime.ToShortDateString()</td>
                    <td style="text-align: center;">@currentTotalTrainingCampsDuration.TotalDuration.TotalMinutes</td>
                    <td style="text-align: center;">–</td>
                    <td style="text-align: center;">–</td>
                    <td style="text-align: center;">–</td>
                    <td style="text-align: center;">–</td>
                    <td style="text-align: center;">–</td>
                    <td style="text-align: center;">–</td>
                </tr>
            }
            else
            {
                previousTotalTrainingCampsDuration = ViewBag.TotalTrainingTimeForTrainingCamps[i - 1];

                double chainGrowthRate = currentTotalTrainingCampsDuration.TotalDuration.TotalMinutes / previousTotalTrainingCampsDuration.TotalDuration.TotalMinutes * 100;
                double baseGrowthRate = currentTotalTrainingCampsDuration.TotalDuration.TotalMinutes / firstTotalTrainingCampsDuration.TotalDuration.TotalMinutes * 100;
                    
                <tr>
                    <td style="text-align: center;">@(i + 1)</td>
                    <td style="text-align: center;">@currentTotalTrainingCampsDuration.TimeInterval.StartIntervalTime.ToShortDateString() - @currentTotalTrainingCampsDuration.TimeInterval.EndIntervalTime.ToShortDateString()</td>
                    <td style="text-align: center;">@currentTotalTrainingCampsDuration.TotalDuration.TotalMinutes</td>
                    <td style="text-align: center;">@(currentTotalTrainingCampsDuration.TotalDuration.TotalMinutes - previousTotalTrainingCampsDuration.TotalDuration.TotalMinutes)</td>
                    <td style="text-align: center;">@(currentTotalTrainingCampsDuration.TotalDuration.TotalMinutes - firstTotalTrainingCampsDuration.TotalDuration.TotalMinutes)</td>
                    <td style="text-align: center;">@(chainGrowthRate.ToString("0.00"))</td>
                    <td style="text-align: center;">@(baseGrowthRate.ToString("0.00"))</td>
                    <td style="text-align: center;">@((chainGrowthRate - 100).ToString("0.00"))</td>
                    <td style="text-align: center;">@((baseGrowthRate - 100).ToString("0.00"))</td>
                   
                </tr>
            }
        }
    }
</table>

<div id="chart" ></div>
    <br>
        <h5 style="width: 1200px;">На графике отчётливо прослеживаются периодические сезонные колебания. Ежемесячные периодические снижения тренировочного времени свиедетельствуют о прерывании тренировочных сборов на период соревнований, праздничных дней или летних каникул, когда не проводятся тренировочные сборы у спортсменов при неизменном тренде.</h5>
    <br>
<div id="chart2" ></div>
    <br>
        <h5 style="width: 1200px;">На графике отчётливо прослеживаются периодические сезонные колебания. Ежемесячные периодические снижения количества тренировок в день свиедетельствуют о прерывании тренировочных сборов на период соревнований, праздничных дней или летних каникул, когда не проводятся тренировочные сборы у спортсменов при неизменном тренде.</h5>
    <br>
<div id="chart3"></div>
    <br>
        <h5 style="width: 1200px;">На графике отчётливо прослеживаются периодические сезонные колебания. Ежемесячные периодические снижения количества рассылок сообщений в день свиедетельствуют о прерывании тренировочных сборов на период праздничных дней, например, в январе или период летних каникул в июне, когда не проводятся тренировочные сборы у спортсменов при неизменном тренде.</h5>
    <br>

</body>


@if (ViewBag.TotalTrainingTimeForTrainingCamps is not null)
{
@section Scripts
{
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        
    <script type="text/javascript">

        // Load the Visualization API and the corechart package.
        google.charts.load('current', {'packages':['corechart']});

         // Set a callback to run when the Google Visualization API is loaded.
         google.charts.setOnLoadCallback(drawChart);
        
          // Callback that creates and populates a data table,
          // instantiates the pie chart, passes in the data and
          // draws it.
          function drawChart() {
    
       
          var data = google.visualization.arrayToDataTable([
          ['Дата', 'Общее тренировочное время за день, мин'],
          
          @foreach (var d in ViewBag.TotalDayTrainingDuration as IEnumerable<TotalDayTrainingDurationView>) {
              <text>[new Date(@d.Date.Year, @d.Date.Month, @d.Date.Day), @d.TotalDuration.TotalMinutes],</text>
          }
          ]);
          
          var options = {
            title: 'График общего время тренировочного процесса по дням',
            curveType: 'function',
            legend: { position: 'bottom' }, 
            height: 500,
            width: 1200
          };

            // Instantiate and draw our chart, passing in some options.
             var chart = new google.visualization.LineChart(document.getElementById('chart'));
                   chart.draw(data, options);
          }
    </script>
    
    <script type="text/javascript">
    
            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart);
          
            function drawChart() {
    
       
            var data = google.visualization.arrayToDataTable([
            ['Дата', 'Количество тренировок за день'],
          
            @foreach (var d in ViewBag.TotalDayTrainingCount as IEnumerable<TotalDayTrainingCountView>) {
                <text>[new Date(@d.Date.Year, @d.Date.Month, @d.Date.Day), @((d.TrainingCount == 2) ? 0 : d.TrainingCount)],</text>
            }
            ]);
          
            var options = {
              title: 'График количества тренировок по дням',
              curveType: 'function',
              legend: { position: 'bottom' }, 
              height: 500,
              width: 1200
            };

            // Instantiate and draw our chart, passing in some options.
             var chart = new google.visualization.LineChart(document.getElementById('chart2'));
                   chart.draw(data, options);
              }
    </script>
    
    <script type="text/javascript">
        
                google.charts.load('current', {'packages':['corechart']});
                google.charts.setOnLoadCallback(drawChart);
              
                function drawChart() {
        
           
                var data = google.visualization.arrayToDataTable([
                ['Дата', 'Количество рассылок за день'],
              
                @foreach (var d in ViewBag.TotalDayMailingCount as IEnumerable<TotalDayMailingCountView>) {
                <text>[new Date(@d.Date.Year, @d.Date.Month, @d.Date.Day), @d.MailingCount],</text>
                }
                ]);
              
                var options = {
                  title: 'График количества рассылок по дням',
                  curveType: 'function',
                  legend: { position: 'bottom' }, 
                  height: 500,
                  width: 1200
                };
    
                // Instantiate and draw our chart, passing in some options.
                 var chart = new google.visualization.LineChart(document.getElementById('chart3'));
                       chart.draw(data, options);
                  }
        </script>
}
}